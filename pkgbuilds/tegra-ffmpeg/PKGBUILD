# Maintainer: Azkali Manad <jgc@archlinux.org>
pkgname=tegra-ffmpeg
pkgbase=tegra-ffmpeg
pkgver=R32
pkgrel=3.1
arch=('aarch64')
license=('GPL')
url="https://ffmpeg.org/"
source=("https://://source.ffmpeg.org/ffmpeg.git")
sha256sums=('SKIP')
depends=('jetson-ffmpeg')

prepare() {
	git clone git://source.ffmpeg.org/ffmpeg.git -b release/4.2 --depth=1
	cd ffmpeg/
	wget https://github.com/jocover/jetson-ffmpeg/raw/master/ffmpeg_nvmpi.patch
	git apply ffmpeg_nvmpi.patch
	./configure --enable-nvmpi
}

build() {
	cd ffmpeg/
	make
}

package_tegra-ffmpeg() {
	cd ffmpeg/
	make install
	ldconfig
}